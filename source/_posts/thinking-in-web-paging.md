---
title: 关于分页问题引发的思考
date: 2016-08-19 15:13:27
tags: 
categories: other
---

如果数据共有N条，采用分页显示，每页显示M条，请问一共有多少页？请给出公式
```javascript
int count = (N % M==0)?(N / M):(N / M + 1);
```
这个做法是比较直观的思路。得出的结果是完全正确的。

<!--more-->

然而这个方案需要一个%运算，一个判断运算，一个除法，而乘除、取余要比加减法效率低太多。如果用另外一种算法，可以减少一次乘除（取余），而且不用if..else...判断，当然也不用三元运算符权当锻炼脑子了，如何设计一个比这个方法效率更高的公式？

# 前言

长时间不接触js的Math中的取整函数`Math.floor`,`Math.round`,`Math.ceil`，当用到的时候容易把那个是向下取整，哪个是向上取整，哪个是四舍五入都搞晕了。

直到群里有小伙伴把floor（地板，肯定是向下咯），和ceil（ceiling天花板，那就向上吧）翻译成中文才变得好记，感谢这位朋友。有时候搞技术还是得触类旁通方能游刃有余，就比如张大神以前把缓动函数解释的深入浅出，触景生情，淋漓尽致，让人记忆犹新啊，哈哈。。


```html
就说说几个不好容易记的吧

ease-in

ease-out

ease-in-out

人脑记忆曲线是下滑的，长时间不接触难免遗忘，但你长得有特点，N年后街角的偶遇，wokao你是大痦子隔壁老王啊！！
关于上面3个缓动函数张大神是这样解释的：
咳咳咳，在XXOO时：
in表示进入，开始进入的时候是慢的，等瞄准就绪后才能快速冲刺，于是乎ease-in似乎表示先慢后快。
out表示出来，出来肯定是先快后慢，因为临近洞口速度肯定要降下来。于是ease-out似乎表示先快后慢。
in-out表示一进一出，也就是先慢后快再慢了。

这场景想象不得不服啊！
```


说到ceil函数，嗯，不错你想到了用ceil函数就可以搞定，我也是通过这个函数才想起4年前我的一位老师给我出的上面一道题。


# (N+M-1)/M——向上取整


多少页肯定是正整数，在高级编程语言中比如java c#，如果定义一个int型的变量，比如`int a=5/2`,那么a=2，在强类型语言中除法都是向下取整的。

表达式的运算结果就是平均最少分多少页。(N+M-1)/M可以分解为N/M+(M-1)/M

分析一下啊：

1. 当N/M正好除尽时，那么0加上(M-1)，除以M，等于0，则结果是商值。
2. 当N/M除不尽时，那么余数加上(M-1)，除以M，等于1，结果是商值加1。

像baidu google这样并发访问量比较高，性能比较高的搜索引擎，他们的分页算法应该不会是三元法来分页，也不知道是如何分页的，应该是底层的代码写的。

针对于高级语言，向上取整--(N+M-1)/M 是个不错的公式，避免用内置函数，提高效率。如果是js还是老老实实的用Math.ceil吧，弱类型就决定它除法不会是整数。